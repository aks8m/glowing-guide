

<html>
<head>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap/dist/css/bootstrap.min.css"/>
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"/>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">

    <title>C-CDA Comparison Tool</title>

    <!-- Required Stylesheets -->
    <link rel="stylesheet" href="app1.css"/>

    <!-- Required scripts -->
    <script src="https://unpkg.com/vue"></script>
    <script src="https://unpkg.com/babel-polyfill@latest/dist/polyfill.min.js"></script>
    <script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</head>
<body>

<!-- item template -->
<script type="text/x-template" id="item-template">
    <li>
        <div v-on:click="toggle">
            <span v-bind:class="{ openelement : isOpen, reselement : isError }">{{item.name}} {{ item.value }}</span>
            <span v-if="isFolder">[{{isOpen ? '-' : '+'}}]</span>
            </button>
        </div>
        <ul v-show="isOpen" v-if="isFolder">
            <tree-item class="item" v-for="child in item.children":key="child.id":item="child"></tree-item>
        </ul>
    </li>
</script>

<!-- item template -->
<script type="text/x-template" id="section-selection">
    <li class="list-group-item list-group-item-action" v-bind:class="{ 'resultbackground' : sectionSelected}">
        <div v-on:click="toggle" class="row">
            <div class="col">
                <span>{{item.name}} {{ item.value }}</span>
                <span v-if="isFolder">[{{isOpen ? '-' : '+'}}]</span>
            </div>
            <div class="col-md-auto">
                <b-badge v-if="isFolder" class="badge-default float-right m-2" v-on:click.stop="setSectionData(source)">Select Section</b-badge>
            </div>
        </div>
        <ul v-show="isOpen" v-if="isFolder" class="list-group">
            <tree-item-section-selection class="item" v-for="child in item.children":key="child.id":item="child":source="source"></tree-item-section-selection>
        </ul>
    </li>
</script>

<!--<div id="app" class="container text-center">-->
<div id="app">


    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#">C-CDA Comparison Tool</a>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="#" v-on:click="clickInstructions()">Instructions</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" v-on:click="clickCompare()">Compare</a>
                </li>
            </ul>
        </div>
    </nav>

    <div v-if="displayInstructions">
        <h1>Welcome to the C-CDA Comparison tool!!</h1>
        <p></p>
        <strong>To get started select your source (EHX) and target (HS) documents.</strong>
        <p></p>

        <p>1. Load source document from your local file explorer, by clicking on "Select Document" or "Browse"</p>
        <p>2. Load target document from your local file explorer, by clicking on "Select Document" or "Browse"</p>
        <p>3. Once the documents have been loaded, the "Compare Documents" button should become enabled.
        <p>4. Click the "Compare Documents" button to compare the source and target documents</p>
        <p>5. Address each result, by removing the result with the "X" button or flagging it as a defect with the "!" button. </p>
        <p/>
        <strong>Results are categorized into 3 categories:</strong>
        <p>1. Value Mistmatch: the value of the XML tags is mismatched</p>
        <p>2. Section Mistmatch: no parent xml tag exists in the target document that has the same attribtues and values as the specified source tag</p>
        <p>3. Attribute Mistmatch: the attribute of the XML tag is mismatched</p>
    </div>

    <div v-if="displayCompare">

        <div class="container" style="padding:10px">
            <div v-if="automatic">
                <compare-button></compare-button>
            </div>
            <div v-if="!automatic">
                <section-compare-button></section-compare-button>
            </div>
        </div>

        <div class="card">
            <div class="card-header" id="compareHeading">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseCompare" aria-expanded="true" aria-controls="collapseCompare">
                        Compare Configurations
                    </button>
                </h5>
            </div>

            <div id="collapseCompare" class="collapse show" aria-labelledby="compareHeading">
                <div class="card-body">
                    <div class="row">

                        <div class="btn-group btn-group-toggle col-md-2" data-toggle="buttons">
                            <label v-bind:class="{ 'btn btn-secondary' : automatic, 'btn btn-outline-secondary' : !automatic }" v-on:click="setAutomatic">
                                <input type="radio" name="options" id="option1" autocomplete="off"> Automatic
                            </label>
                            <label v-bind:class="{ 'btn btn-secondary' : !automatic, 'btn btn-outline-secondary' : automatic }" v-on:click="setManual">
                                <input type="radio" name="options" id="option2" autocomplete="off"> Manual
                            </label>
                        </div>
                        <div class="col-md-5">
                            <file-input path='/api/analysis/readSource' name="sourceTree"></file-input>
                        </div>
                        <div class="col-md-5">
                            <file-input path='/api/analysis/readTarget' name="targetTree"></file-input>
                        </div>

                    </div>
                    <div class="row" style="padding-top:10px" v-if="!automatic">
                        <div class="col-md-2">

                            <button type="button" id="show-btn" class="btn btn-outline-secondary btn-block" @click="$bvModal.show('bv-modal-section-selection')">Select Sections</button>

                            <b-modal id="bv-modal-section-selection" hide-footer size="xl">
                                <template slot="modal-title">
                                    Section Selection
                                </template>
                                <div class="row">
                                    <div class="col">
                                        <p>Source:</p>
                                        <ul>
                                            <tree-item-section-selection class="item" :item="sourceTreeData":source="true"></tree-item-section-selection>
                                        </ul>
                                    </div>
                                    <div class="col">
                                        <p>Target: {{ targetSectionData.name }}</p>
                                        <ul>
                                            <tree-item-section-selection class="item" :item="targetTreeData":source="false"></tree-item-section-selection>
                                        </ul>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <p>Selected Section: {{ sourceSectionData.name }}</p>
                                    </div>
                                    <div class="col">
                                        <p>Selected Section: {{ targetSectionData.name}}</p>
                                    </div>
                                </div>
                                <b-button class="mt-3" block @click="$bvModal.hide('bv-modal-section-selection'); closeEveryNode()">Close Me</b-button>
                            </b-modal>

                        </div>
                        <div class="col-md-5">
                            <p>{{ this.sourceSectionData.name }}</p>
                        </div>
                        <div class="col-md-5">
                            <p>{{ this.targetSectionData.name }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header" id="headingTree">
                <h5 class="mb-0">
                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTree" aria-expanded="false" aria-controls="collapseTree">
                        Tree Displays
                    </button>
                </h5>
            </div>
            <div id="collapseTree" class="collapse" aria-labelledby="headingTree">
                <div class="card-body">
                    <div class="row text-left">
                        <div class="col right">
                            <h4>Source Tree:</h4>
                            <ul>
                                <tree-item class="item" :item="sourceTreeData"></tree-item>
                            </ul>
                        </div>
                        <div class="col">
                            <h4>Target Tree:</h4>
                            <ul>
                                <tree-item class="item" :item="targetTreeData"></tree-item>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header" id="headingResults">
                <h5 class="mb-0">
                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseResults" aria-expanded="false" aria-controls="collapseResults">
                        Compare Results
                    </button>
                </h5>
            </div>
            <div id="collapseResults" class="collapse" aria-labelledby="headingResults">
                <div class="card-body">
                    <div class="row">
                        <div class="col col-md-2 right">
                            <div class="row" style="padding-top:10px; padding-bottom:10px">
                                <div id="main">
                                    <b-form-input type="text" v-model="search" placeholder="Filter Results..."></b-form-input>
                                </div>
                            </div>

                            <div class="form-check form-check"><input id="checkBoxFilterAll" type="checkbox" class="form-check-input":checked="true" v-model="selectAll"><label for="checkBoxFilterAll" class="form-check-label">All Mismatches  <span class="badge badge-light"> {{ results.length }}</span></label></div>
                            <div class="form-check form-check"><input id="checkBoxFilterValue" type="checkbox" class="form-check-input" v-model="value"/><label for="checkBoxFilterValue" class="form-check-label">Value Mismatches  <span class="badge badge-light"> {{ valueresults.length }}</span></label></div>
                            <div class="form-check form-check"><input id="checkBoxFilterAttribute" type="checkbox" class="form-check-input" v-model="attribute"/><label for="checkBoxFilterAttribute" class="form-check-label">Attribute Mismatches  <span class="badge badge-light"> {{ attributeresults.length }}</span></label></div>
                            <div class="form-check form-check"><input id="checkBoxFilterSection" type="checkbox" class="form-check-input" v-model="section"/><label for="checkBoxFilterSection" class="form-check-label">Section Mismatches  <span class="badge badge-light"> {{ sectionresults.length }}</span></label></div>


                        </div>
                        <div class="col" style="padding-top:10px">
                            <div class="row">
                                <div class="col">
                                    <h4>Results List:</h4>
                                </div>
                                <div class="col-md-auto">
                                    <button type="button" class="btn btn-secondary btn-sm" v-on:click="addDeleted()">Add {{ deletedresults.length }} Deleted Results back to Result List</button>
                                </div>
                                <div class="col-md-auto">
                                    <button type="button" class="btn btn-secondary btn-sm" v-b-modal.modal-2>Display {{ defectresults.length }} Flagged Defects</button>

                                    <b-modal id="modal-2" title="Defects" ok-only>
                                        <ol class="list-group">
                                            <li type="button" class="list-group-item list-group-item-action" v-for="(result, index) in defectresults":key="index">{{result.output}}</li>
                                        </ol>
                                    </b-modal>

                                </div>
                            </div>
                            <ul class="list-group">
                                <result-list v-for="result in getFilteredResults":key="result.sourceid":output="result.output":sourceid="result.sourceid":targetid="result.targetid":type="result.resultType":class="{resultbackground: this.resultStyle}"></result-list>
                            </ul>
                        </div>

                    </div>



                </div>
                </div>
            </div>
        </div>
    </div>

</div>


<script src="app5.js"></script>

</body>
</html>